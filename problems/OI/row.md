Zadanie Równanie na słowach (row) - Baza zadań - Szkopuł

Kontakt

# Równanie na słowach

### Limit pamięci: 32 MB

Słowem dwójkowym nazywamy każdy niepusty ciąg złożony z
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAAmSURBVAiZY2hgAIEGBgcgPACEBUA4gUEBzAZBBQYjhiogrGCwAgDG+AmJGHCAfgAAAABJRU5ErkJggg==)
lub
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALAQAAAAEDLvGtAAAAAnRSTlMAAQGU/a4AAAAfSURBVAiZY2hggMADDAxg+gEQNjAsgEMGBh2GNxAIAAbnDP3++BXkAAAAAElFTkSuQmCC).
Równanie na słowach ma postać
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJ8AAAAKAQAAAAH1zIErAAAAAnRSTlMAAQGU/a4AAADHSURBVAiZJYyxSsNQFIZ/HyTkIdzzCn2DIs5acXRpHsHNUUfBza2g7S04uFkndSkdAs1UcyFCcrnJ+bzif+Dn4zucI/Dix2sa3+WiV2NVDDoerEYjpyUySqKA0dnK8aks2y6cFbPDWnlOz7CEGzkHzpYlH3JJPOeHC0x59vSInZ1v30SEcpzteFBNnf7R4o9sM94ljIWa16ZK1DUwfIXF336uSTeJdb2530G4bYsQ2v2J6P7vk2TFVWrbi5c0KdfQ95c+UfX9C5y7qQux7prDAAAAAElFTkSuQmCC),
gdzie
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAKAQAAAAE9jKm4AAAAAnRSTlMAAQGU/a4AAAAxSURBVAiZYzjAcICBgaGB4QGDAhA/YPjDIMAgwbADCCUYPjA8f8Dw/gCDfwPDfxACADVED6A0Q89lAAAAAElFTkSuQmCC)
i
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQAAAAEJCVHcAAAAAnRSTlMAAQGU/a4AAAA7SURBVAiZY3BgcGBoYGBgeMCgAMQHGNYwTGD4w1DDEAOEMgx7GL4w3PzAMPsAg/EEhu8XGOQnMPwrAABw5hCkW+qOJgAAAABJRU5ErkJggg==)
są cyframi dwójkowymi
(![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAAmSURBVAiZY2hgAIEGBgcgPACEBUA4gUEBzAZBBQYjhiogrGCwAgDG+AmJGHCAfgAAAABJRU5ErkJggg==)
lub
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALAQAAAAEDLvGtAAAAAnRSTlMAAQGU/a4AAAAfSURBVAiZY2hggMADDAxg+gEQNjAsgEMGBh2GNxAIAAbnDP3++BXkAAAAAElFTkSuQmCC))
lub zmiennymi, to jest małymi literami alfabetu angielskiego. Dla każdej
zmiennej jest ustalona długość słów dwójkowych, które można podstawiać w jej
miejsce. Długość tę nazywamy długością zmiennej. Rozwiązanie równania na
słowach polega na przypisaniu każdej zmiennej słowa dwójkowego o
odpowiadającej tej zmiennej długości, w taki sposób, by po zastąpieniu
zmiennych w równaniu przez przypisane im słowa, obie strony równania (słowa
dwójkowe) były takie same.

Dla danego równania na słowach policz ile jest różnych rozwiązań tego
równania.

## Przykład

Niech
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAOAQAAAAHJrLeDAAAAAnRSTlMAAQGU/a4AAACESURBVAiZNYyxDcJADEU/igQDsAgdZbIVpSOxQygZBCm+DY4F0KW7MulcxR8fEnryf7IsfxSAgAQvjmCMxd7M24hPuBR6QlEy4X5+THHtdR7gVG0f/xygopowXU/H1mCWUL0yM+8J5saV677g5+CNA5/eeccLqppmybKAJVDqhpYUyvYFQU1nNy4c5g0AAAAASUVORK5CYII=)
będą długościami zmiennych
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAAOAQAAAAErcKz6AAAAAnRSTlMAAQGU/a4AAACVSURBVAiZLYyxDcIwFERvAsagpKGgQAqZgJbSJQOgKFWwJQbJBNBQIuFswAaxF0AuI2S+jx+JX9y9K94HHYwDYXBvAeqcJodWuWgH3dQbYM/lWeOyWd1q0NK7f/a7qgLMKF9gpHQOh+V+oZ+mlGa3VzsxKnmll9KD25IkyIA1T8JPnyMaf+ze+ZoHMNAXltnwtEJh/AF6F2R8rGCCSAAAAABJRU5ErkJggg==)
w poniższym równaniu:
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAALAQAAAAFPxPxVAAAAAnRSTlMAAQGU/a4AAACaSURBVAiZY/h/gWHvB4b3Dxh6HzCc+p/CEF//j+HqfxeG/4/SGP6DwB+G76H//317wjA5dP5/oRSG7X/3///3A0ZtNtz/3yiBYc/7/f/WNzCsW72Hf+0NBmFB+X+bEhj05///rQ8y4l/9A4b3+/9/fg/m/AdyrMvL3/9g+Pe+5O0BhvdFaelAmT/n/p4GyqS9eg3k/L32dfYBAJfiZlro32e1AAAAAElFTkSuQmCC)
To równanie ma
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAALAQAAAAEQ+bFZAAAAAnRSTlMAAQGU/a4AAAAzSURBVAiZYzjA0ACEB4DQAYgfMPxj+MYwg2EXwzYg3gOEQgz6Oxje1zC8N2B4X8Hw3gIAm5wRYA/l8jAAAAAASUVORK5CYII=)
różnych rozwiązań.

## Zadanie

Napisz program, który:

  * wczytuje ze standardowego wejścia liczbę równań i ich opisy; 
  * znajduję liczbę rozwiązań każdego równania; 
  * zapisuje wyniki na standardowe wyjście. 

## Wejście

W pierwszym wierszu standardowego wejścia znajduje się liczba całkowita
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHAQAAAAGbLlroAAAAAnRSTlMAAQGU/a4AAAAeSURBVAiZY2hgYGA4AMYfGASA9AIgZGB4xvCOwQ8AUhIGY40uY6IAAAAASUVORK5CYII=),
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAANAQAAAAFPOMUtAAAAAnRSTlMAAQGU/a4AAACDSURBVAiZLczrCQIxEATg6cASrgQtQFgrsgHBpANLSCfZNKIIKSB3HPgi2XEFl/kxfAMLRvyCK54CrGvE6QO0I8BHRK2+JeYCBgsFyYSANt4KVCkF2fZ2QA5n/6IpaMRk4mKbPhVsuZCsfYfGiTQZM1on05ujuF2o7ndvryFc3Pi/+Qvj0GAWhq8eHAAAAABJRU5ErkJggg==).
Jest to liczba równań. Następne wiersze zawierają opisy
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHAQAAAAGbLlroAAAAAnRSTlMAAQGU/a4AAAAeSURBVAiZY2hgYGA4AMYfGASA9AIgZGB4xvCOwQ8AUhIGY40uY6IAAAAASUVORK5CYII=)
równań. Na każdy opis składa się
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALAQAAAAEDLvGtAAAAAnRSTlMAAQGU/a4AAAAnSURBVAiZY2hgAAEICaIfMCQAyQVAcgHDASBUYNjBUMNgwFDBYAEApNgIleJjTj8AAAAASUVORK5CYII=)
wierszy. Między kolejnymi opisami nie ma pustych wierszy. Każde równanie jest
opisane w następujący sposób:

W pierwszym wierszu opisu znajduje się liczba całkowita
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAApSURBVAiZY2hgYGCAYAcgeYBhAxA6MCgwPACSCUB4gOEeEM5j6GMwAQC/QAn9uKaFtwAAAABJRU5ErkJggg==),
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAANAQAAAAFc74XZAAAAAnRSTlMAAQGU/a4AAACZSURBVAiZNYwxDoJAFAXfDTwCjQcwsTRmuZGNCRoSPjfwBuIBLC2NcAJbG102oUXFUIhx+U8ap53J4A1ICElxSxGZAm3rEH9DPBcpNNqhqhwkk5OHSCI1Ms10AvMQu0SZ0+xh9cgDbKJcodwy72CY6xg68oHHlC8Kq/48bBlQ1PT3BrGnyoe8Flhzo2Ywc4cZO38Z+tqBf5ofNiFkZalPjJcAAAAASUVORK5CYII=).
Jest to liczba różnych zmiennych w równaniu. Przyjmujemy, że zawsze zmiennymi
jest
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAApSURBVAiZY2hgYGCAYAcgeYBhAxA6MCgwPACSCUB4gOEeEM5j6GMwAQC/QAn9uKaFtwAAAABJRU5ErkJggg==)
pierwszych małych liter alfabetu angielskiego. W drugim wierszu jest zapisany
ciąg
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAApSURBVAiZY2hgYGCAYAcgeYBhAxA6MCgwPACSCUB4gOEeEM5j6GMwAQC/QAn9uKaFtwAAAABJRU5ErkJggg==)
liczb całkowitych dodatnich oddzielonych pojedynczymi odstępami. Te liczby to
długości
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAApSURBVAiZY2hgYGCAYAcgeYBhAxA6MCgwPACSCUB4gOEeEM5j6GMwAQC/QAn9uKaFtwAAAABJRU5ErkJggg==)
kolejnych zmiennych
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAOAQAAAAHgq0gEAAAAAnRSTlMAAQGU/a4AAABnSURBVAiZY/jDEMMAwps/MPz/wPD9A0M5mAFC//8z1Nf/Z+g2e8fwv/4fGM+3/8cQf/8fw73//xiC1d4w/P4OFP8///9/ELUfRO3+bw2ijP8Xg6jS++k1f34w/H8PlAQquf+//v8/AOx+SGmCEeKdAAAAAElFTkSuQmCC)
występujących w równaniu.

Trzeci wiersz opisu zawiera tylko jedną dodatnią liczbę całkowitą
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAKAQAAAAEuW+lMAAAAAnRSTlMAAQGU/a4AAAAbSURBVAiZY2hgYGBAYAcGGGhgOMCwAAgTGBwAVIQFYVvoLrkAAAAASUVORK5CYII=).
Jest to długość lewej strony równania — tj. długość słowa utworzonego z cyfr
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAALAQAAAAHs7JqTAAAAAnRSTlMAAQGU/a4AAAAmSURBVAiZY2hgAIEGBgcgPACEBUA4gUEBzAZBBQYjhiogrGCwAgDG+AmJGHCAfgAAAABJRU5ErkJggg==)
lub
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALAQAAAAEDLvGtAAAAAnRSTlMAAQGU/a4AAAAfSURBVAiZY2hggMADDAxg+gEQNjAsgEMGBh2GNxAIAAbnDP3++BXkAAAAAElFTkSuQmCC)
i jednoliterowych zmiennych. W następnym wierszu jest zapisana lewa strona
równania jako ciąg
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAKAQAAAAEuW+lMAAAAAnRSTlMAAQGU/a4AAAAbSURBVAiZY2hgYGBAYAcGGGhgOMCwAAgTGBwAVIQFYVvoLrkAAAAASUVORK5CYII=)
cyfr lub zmiennych bez odstępów między nimi. Następne dwa wiersze zawierają
opis prawej strony równania. Pierwszy z tych wierszy zawiera dodatnią liczbę
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHAQAAAAGbLlroAAAAAnRSTlMAAQGU/a4AAAAjSURBVAiZY2hgaGA4wMDA4MCwgeEDkF7A8IAhgSGP4R7DPABgmgdrAGPebwAAAABJRU5ErkJggg==).
Jest to długość prawej strony równania. Drugi z wierszy zawiera prawą stronę
równania zapisaną w taki sam sposób jak jego lewa strona. Liczba cyfr plus
suma długości wszystkich zmiennych (licząc wszystkie wystąpienia każdej
zmiennej) po każdej stronie równania nie przekracza
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAALAQAAAAG5jXnNAAAAAnRSTlMAAQGU/a4AAABNSURBVAiZY/jAsIZhBsMDhjsLGKIWMPx/AELfv94B45nnUhg2nznBsHd/AQoWBorpGz8rNlZgeF/9vnz7AjhV+d58egPDe+vnxZsXAAAYxC4ahDJf2gAAAABJRU5ErkJggg==).

## Wyjście

Dla każdego
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAALAQAAAAEH2yGQAAAAAnRSTlMAAQGU/a4AAAAgSURBVAiZY2hgaGCAgAaGA2D2ASB0gMIPQHiBYQNDAgCW6AkBJunwlwAAAABJRU5ErkJggg==),
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAANAQAAAAFCJrVqAAAAAnRSTlMAAQGU/a4AAACASURBVAiZLYuxDcJADEX/BoyQERiBjehRFNkbZIRsEl9HyQZJQYGoTgihXHH4x4f4hfX87A8qPgpixXYG3g9FvyEvoON+BSeXuMrgiolSActiCjOP4ux9mFkuwfb77FyKwg/lpDjyRbJjQo7ZlqBK2o21uZFS+G1UfOX4TOA/aQdOK1/ueu6QoAAAAABJRU5ErkJggg==),
Twój program powinien zapisać w
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAALAQAAAAEH2yGQAAAAAnRSTlMAAQGU/a4AAAAgSURBVAiZY2hgaGCAgAaGA2D2ASB0gMIPQHiBYQNDAgCW6AkBJunwlwAAAABJRU5ErkJggg==)-tym
wierszu standardowego wyjścia liczbę różnych rozwiązań
![Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAALAQAAAAEH2yGQAAAAAnRSTlMAAQGU/a4AAAAgSURBVAiZY2hgaGCAgAaGA2D2ASB0gMIPQHiBYQNDAgCW6AkBJunwlwAAAABJRU5ErkJggg==)-tego
równania.

## Przykład

Dla danych wejściowych:

    
    
    1
    5
    4 2 4 4 2
    5
    1bad1
    4
    acbe
    

poprawną odpowiedzią jest:

    
    
    16
    

_Autor zadania: Wojciech Rytter._

